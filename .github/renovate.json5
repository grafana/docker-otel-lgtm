{
  $schema: "https://docs.renovatebot.com/renovate-schema.json",
  extends: ["config:recommended", "customManagers:dockerfileVersions", "customManagers:githubActionsVersions"],
  branchPrefix: "grafanarenovatebot/",
  dependencyDashboard: true,
  platformCommit: "enabled",
  automerge: true,
  ignorePaths: [],
  ignorePresets: [":ignoreModulesAndTests"],
  ignoreUnstable: true,
  packageRules: [
    {
      matchPackageNames: ["open-telemetry/opentelemetry-collector-releases"],
      allowedVersions: "!/cmd/",
    },
    {
      matchPackageNames: ["grafana/loki"],
      allowedVersions: "!/operator/",
    },
    {
      matchPackageNames: ["ghcr.io/renovatebot/renovate", "renovatebot/github-action"],
      groupName: "renovatebot",
      schedule: ["before 4am on monday"],
    },
    {
      matchPackageNames: ["jdx/mise"],
      groupName: "mise",
      schedule: ["before 4am on monday"],
    },
    {
      matchPackageNames: ["/^(ghcr.io/)?super-linter/super-linter$/"],
      groupName: "super-linter",
    },
    {
      matchDatasources: ["pypi"],
      matchDepNames: ["opentelemetry-distro"],
      ignoreUnstable: false,
    },
    {
      matchPackageNames: ["grafana/grafana", "grafana/loki", "grafana/pyroscope", "grafana/tempo", "open-telemetry/opentelemetry-collector-releases", "prometheus/prometheus"],
      labels: ["docker-dependency"],
    },
    {
      matchPackageNames: ["grafana/shared-workflows"],
      versioning: "regex:^(?<compatibility>[a-z-]+)-v(?<major>\\d+)\\.(?<minor>\\d+)\\.(?<patch>\\d+)?$",
    },
    {
      extends: ["monorepo:dotnet"],
      description: ["Disable major version updates for .NET"],
      matchUpdateTypes: ["major"],
      enabled: false,
    },
  ],
  vulnerabilityAlerts: {
    enabled: true,
    labels: ["automerge-security-update"],
  },
  osvVulnerabilityAlerts: true,
  customManagers: [
    {
      customType: "regex",
      depNameTemplate: "ghcr.io/renovatebot/renovate",
      datasourceTemplate: "docker",
      managerFilePatterns: ["/^\\.github/workflows/renovate.yml$/"],
      matchStrings: ["renovate-version: (?<currentValue>[^@\\s]+)(?:@(?<currentDigest>\\S+))?", "RENOVATE_IMAGE=ghcr.io/renovatebot/renovate:(?<currentValue>[^@\\s]+)(?:@(?<currentDigest>\\S+))?"],
    },
    {
      customType: "regex",
      description: "Update _VERSION variables in shell scripts",
      managerFilePatterns: ["/run.sh$/"],
      matchStrings: ['# renovate: datasource=(?<datasource>[a-z-]+?)(?: depName=(?<depName>.+?))?(?: packageName=(?<packageName>.+?))?(?: versioning=(?<versioning>[a-z-]+?))?\\s.+?_VERSION="?(?<currentValue>.+?)"?\\s'],
    },
    {
      customType: "regex",
      description: "Update _VERSION variables in mise.toml",
      managerFilePatterns: ["/^mise\\.toml$/"],
      matchStrings: ['# renovate: datasource=(?<datasource>[a-z-]+?)(?: depName=(?<depName>.+?))?(?: packageName=(?<packageName>.+?))?(?: versioning=(?<versioning>[a-z-]+?))?\\s.+?_VERSION="?(?<currentValue>[^@"]+?)(?:@(?<currentDigest>sha256:[a-f0-9]+))?"?\\s'],
    },
    {
      customType: "regex",
      description: "update mise",
      managerFilePatterns: ["/(^|/)(workflow-templates|\\.(?:github|gitea|forgejo)/(?:workflows|actions))/.+\\.ya?ml$/", "/(^|/)action\\.ya?ml$/"],
      datasourceTemplate: "github-release-attachments",
      packageNameTemplate: "jdx/mise",
      depNameTemplate: "mise",
      matchStrings: ["jdx/mise-action.*\\n\\s*with:\\s*\\n\\s*version: [\"']?(?<currentValue>v[.\\d]+)[\"']?\\s*\\n\\s*sha256: [\"']?(?<currentDigest>\\w+)[\"']?"],
    },
  ],
}
