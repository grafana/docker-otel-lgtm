# pin all versions to avoid GitHub rate limit
[tools]
go = "1.25.5"
"go:github.com/grafana/oats" = "0.6.0"
java = "temurin-25.0.1+8.0.LTS"
lychee = "0.20.1"
markdownlint-cli2 = "0.20.0"
rust = "1.91.1"

[tasks.lint]
run = "scripts/super-linter.sh"

[tasks.lint-markdown]
run = "markdownlint-cli2 --fix ."

[tasks.lint-links]
run = "lychee --cache --include-fragments ."

[tasks.lint-all]
depends = ["lint", "lint-links"]

[tasks.lint-rest]
description = "All lints not covered by super linter"
depends = ["lint-links"]

[tasks.lgtm]
run = './run-lgtm.sh {{arg(name="tag", default="latest")}}'

[tasks.local-lgtm]
description = "Run locally built LGTM image"
run = './run-lgtm.sh latest true'

[tasks.example]
alias = "example-java"
run = "./run-example.sh"

[tasks.example-nodejs]
dir = "examples/nodejs"
run = "./run.sh"

[tasks.example-python]
dir = "examples/python"
run = "./run.sh"

[tasks.example-go]
dir = "examples/go"
run = "./run.sh"

[tasks.example-dotnet]
dir = "examples/dotnet"
run = "./run.sh"

[tasks.generate-traffic]
run = "./generate-traffic.sh"

[tasks.all]
depends = ["lgtm", "example", "generate-traffic"]

[tasks.k8s-apply]
run = "kubectl apply -f k8s/lgtm.yaml"

[tasks.k8s-port-forward]
run = "kubectl port-forward service/lgtm 3000:3000 4040:4040 4317:4317 4318:4318 9090:9090"

[tasks.build-lgtm]
run = './build-lgtm.sh {{arg(name="tag", default="latest")}}'

[settings]
# for go backend
experimental = true
